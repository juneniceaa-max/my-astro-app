<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŠ¨æ€æ˜Ÿç›˜å®éªŒå®¤ V2.8</title>
    <style>
        :root { --primary: #7d5fff; --secondary: #3ae374; --bg: #05050a; }
        body { font-family: 'PingFang SC', system-ui, sans-serif; background: var(--bg); color: white; margin: 0; display: flex; justify-content: center; padding: 20px; }
        .app-container { width: 100%; max-width: 500px; }
        .glass-card { 
            background: rgba(255, 255, 255, 0.05); 
            backdrop-filter: blur(15px); 
            border-radius: 24px; 
            padding: 25px; 
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            margin-bottom: 20px;
        }
        h1 { font-size: 24px; text-align: center; background: linear-gradient(to right, #a29bfe, #6c5ce7); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        label { font-size: 14px; color: #aaa; margin-left: 5px; }
        input, select { 
            width: 100%; padding: 15px; margin: 10px 0 20px; 
            background: rgba(0,0,0,0.3); border: 1px solid #333; 
            border-radius: 12px; color: white; box-sizing: border-box;
        }
        button { 
            width: 100%; padding: 16px; border-radius: 12px; border: none;
            background: linear-gradient(135deg, #6c5ce7, #a29bfe);
            color: white; font-weight: bold; cursor: pointer; transition: 0.3s;
        }
        button:hover { transform: translateY(-2px); filter: brightness(1.1); }
        .result-row { display: flex; justify-content: space-between; padding: 15px 0; border-bottom: 1px solid rgba(255,255,255,0.05); }
        .astro-val { color: var(--secondary); font-weight: 600; }
        .dynamic-report { 
            margin-top: 20px; padding: 15px; background: rgba(125, 95, 255, 0.1); 
            border-radius: 15px; font-size: 14px; line-height: 1.8; color: #d1d1d1;
            border-left: 4px solid var(--primary);
        }
    </style>
</head>
<body>
    <div class="app-container">
        <h1>ğŸŒŒ åŠ¨æ€æ˜Ÿç›˜æ¨ç®—</h1>
        
        <div class="glass-card">
            <label>ğŸ•°ï¸ å‡ºç”Ÿæ—¶é—´ (ç²¾ç¡®åˆ°åˆ†)</label>
            <input type="datetime-local" id="birthTime" value="2000-01-01T12:00">
            
            <label>ğŸ“ å‡ºç”ŸåŸå¸‚</label>
            <select id="citySelect">
                <option value="116.4">åŒ—äº¬ (ç»åº¦ 116.4E)</option>
                <option value="121.4">ä¸Šæµ· (ç»åº¦ 121.4E)</option>
                <option value="113.2">å¹¿å· (ç»åº¦ 113.2E)</option>
                <option value="114.0">æ·±åœ³ (ç»åº¦ 114.0E)</option>
                <option value="104.0">æˆéƒ½ (ç»åº¦ 104.0E)</option>
            </select>
            
            <button onclick="runAstroEngine()">ç”Ÿæˆå®æ—¶æŠ¥å‘Š</button>
        </div>

        <div id="resultArea" class="glass-card" style="display:none;">
            <div class="result-row"><span>â˜€ï¸ å¤ªé˜³åˆ†å¸ƒ</span> <span class="astro-val" id="sun"></span></div>
            <div class="result-row"><span>ğŸŒ™ æœˆäº®åˆ†å¸ƒ</span> <span class="astro-val" id="moon"></span></div>
            <div class="result-row"><span>â¬†ï¸ ä¸Šå‡ç‚¹</span> <span class="astro-val" id="asc"></span></div>
            <div class="result-row"><span>ğŸ’– é‡‘æ˜Ÿå¼•åŠ›</span> <span class="astro-val" id="venus"></span></div>
            
            <div class="dynamic-report" id="report">
                </div>
        </div>
    </div>

    <script>
        function runAstroEngine() {
            const time = new Date(document.getElementById('birthTime').value);
            const lng = parseFloat(document.getElementById('citySelect').value);
            const signs = ["ç™½ç¾Š", "é‡‘ç‰›", "åŒå­", "å·¨èŸ¹", "ç‹®å­", "å¤„å¥³", "å¤©ç§¤", "å¤©è", "å°„æ‰‹", "æ‘©ç¾¯", "æ°´ç“¶", "åŒé±¼"];
            const elements = { "ç™½ç¾Š":"ç«", "ç‹®å­":"ç«", "å°„æ‰‹":"ç«", "é‡‘ç‰›":"åœŸ", "å¤„å¥³":"åœŸ", "æ‘©ç¾¯":"åœŸ", "åŒå­":"é£", "å¤©ç§¤":"é£", "æ°´ç“¶":"é£", "å·¨èŸ¹":"æ°´", "å¤©è":"æ°´", "åŒé±¼":"æ°´" };

            // 1. æ¨¡æ‹Ÿå®æ—¶æ˜Ÿå†ç®—æ³•
            const dayOfYear = (time - new Date(time.getFullYear(), 0, 0)) / 86400000;
            const hour = time.getHours() + time.getMinutes() / 60;
            
            const sunIdx = Math.floor(((dayOfYear + 284) % 365 / 365) * 12);
            const moonIdx = Math.floor((dayOfYear * 13.18 + 5) % 12); // æœˆäº®è¿è¡Œå‘¨æœŸçº¦27.3å¤©
            const ascIdx = Math.floor((sunIdx + (hour - 12) / 2 + (lng - 120) / 15 + 12) % 12);
            const venusIdx = (sunIdx + (dayOfYear % 2 === 0 ? 1 : -1)) % 12;

            // 2. æ˜¾ç¤ºåŸºæœ¬æ•°æ®
            document.getElementById('resultArea').style.display = 'block';
            document.getElementById('sun').innerText = signs[sunIdx] + "åº§";
            document.getElementById('moon').innerText = signs[moonIdx] + "åº§";
            document.getElementById('asc').innerText = signs[((ascIdx % 12) + 12) % 12] + "åº§";
            document.getElementById('venus').innerText = signs[((venusIdx % 12) + 12) % 12] + "åº§";

            // 3. ç¼–å†™åŠ¨æ€éç¼–åˆ¶é€»è¾‘
            const sunElem = elements[signs[sunIdx]];
            const moonElem = elements[signs[moonIdx]];
            
            let analysis = `âœ¨ <b>å®æ—¶èƒ½é‡åˆæˆæŠ¥å‘Šï¼š</b><br>`;
            analysis += `å½“å‰å®‡å®™å¤©çº¿èšç„¦åœ¨ä½ çš„<b>${sunElem}å…ƒç´ </b>æ ¸å¿ƒã€‚`;
            
            if (sunElem === moonElem) {
                analysis += ` ä½ çš„å†…åœ¨éœ€æ±‚ä¸å¤–åœ¨è¡¨ç°é«˜åº¦ç»Ÿä¸€ï¼Œè¿™ç§â€œåŒé‡${sunElem}â€çš„ç‰¹è´¨è®©ä½ åœ¨å†³ç­–æ—¶éå¸¸æœæ–­ã€‚`;
            } else {
                analysis += ` ä½ çš„${sunElem}å‘äººæ ¼æ­£åœ¨ä¸${moonElem}å‘çš„æƒ…ç»ªå®‰å…¨æ„Ÿè¿›è¡Œäº¤äº’ã€‚è¿™æ˜¯ä¸€ç§éœ€è¦å¹³è¡¡çš„åŠ¨æ€å¼ åŠ›ã€‚`;
            }

            const currentHour = new Date().getHours();
            analysis += `<br><br>ğŸ”® <b>å½“å‰æ—¶ç©ºå»ºè®®ï¼š</b> æ­¤æ—¶æ­¤åˆ»å¤©é™…èƒ½é‡ä½äºç¬¬${(currentHour % 12) + 1}å®«ä½ï¼Œå»ºè®®å…³æ³¨â€œ${['èµ„æºç§¯ç´¯', 'äº¤æµè¡¨è¾¾', 'å®¶åº­æ ¹åŸº', 'ä¸ªäººæ‰å'][currentHour % 4]}â€é¢†åŸŸã€‚`;

            document.getElementById('report').innerHTML = analysis;
        }
    </script>
</body>
</html>